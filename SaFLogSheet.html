<input type="radio" name="attr_tab" class="sheet-tab sheet-containerUnit sheet-size1" value="1" checked="checked"><span
        title="Unit"></span>
<input type="radio" name="attr_tab" class="sheet-tab sheet-containerStronghold sheet-size2" value="2"><span title="Stronghold"></span>
<input type="radio" name="attr_tab" class="sheet-tab sheet-containerProvince sheet-size3" value="3"><span title="Province"></span>
<div class="sheet-tab-content sheet-containerUnit">
        <input type='checkbox' class="sheet-editCheckBox" name='attr_editEnabled' value='1' checked='false' /><span></span>

        <div class="sheet-containerInput">
                <div>
                        <div class="col sheet-input">
                                <input type="text" class="sheet-input" name="attr_character_name" />
                                <div class="2colrow sheet-input">
                                        <div class="col">
                                                <input type="text" name="attr_Ancestry" placeholder="Ancestry" />
                                        </div>
                                        <div class="col">
                                                <input type="text" name="attr_Experience" placeholder="Experience">
                                        </div>
                                </div>
                                <div class="2colrow sheet-input">
                                        <div class="col">
                                                <input type="text" name="attr_Equipment" placeholder="Equipment" />
                                        </div>
                                        <div class="col">
                                                <input type="text" name="attr_UnitType" placeholder="Type" />
                                        </div>
                                </div>
                        </div>
                        <div class="sheet-input">
                                <label>Cost:</label><input type="number" name="attr_Cost" placeholder="-" />
                        </div>
                </div>
        </div>
        <div class="sheet-containerDisplay">
                <h2><span name="attr_character_name"></span></h2>
                <hr>
                </hr>
                <h3><span name="attr_Ancestry"></span><span display:inline-block;>&nbsp;</span><span name="attr_Experience">
                        </span></h3>
                <h3><span name="attr_Equipment"></span><span display:inline-block;>&nbsp;</span><span name="attr_UnitType">
                </h3>
                <h3><span>Cost:&nbsp;</span><span name="attr_Cost">
                        </span></h3>
        </div>
        <div class="sheet-containerInput">
                <div class="2colrow">
                        <div class="col">
                                <label>Attack:</label><input type="number" name="attr_Attack" placeholder="-" />
                                <div></div>
                        </div>
                        <div class="col">
                                <label>Defense:</label><input type="number" name="attr_Defence" placeholder="-" />
                                <div></div>
                        </div>
                </div>
                <div class="2colrow">
                        <div class="col">
                                <label>Power:</label><input type="number" name="attr_Power" placeholder="-" />
                        </div>
                        <div class="col">
                                <label>Toughness:</label><input type="number" name="attr_Toughness" placeholder="-" />
                        </div>
                </div>
                <div class="2colrow">
                        <div class="col">
                                <label>Morale:</label><input type="number" name="attr_Morale" placeholder="-" />
                        </div>
                        <div class="col">
                                <label>Size:</label><input type="number" name="attr_Size_max" placeholder="-" />
                        </div>
                </div>

        </div>
        <div class="sheet-containerDisplay">
                <hr>
                </hr>
                <div class="sheet-container">
                        <button class="sheet-button-roll" type='roll' value='&{template:5eAttack} {{name=@{character_name}}}{{subtags=Attack, @{inputAncestry} @{inputExperience}}} {{attack=[[1d20+@{inputAttack}]]}} {{attackadv=[[1d20+@{inputAttack}]]}}'
                                name='roll_Attack'>
                                <div>
                                        <h3>Attack:&nbsp;<span name="attr_Attack"></span></h3>
                                </div>
                        </button>
                        <div>
                                <h3>Defence:&nbsp;<span name="attr_Defence"></h3>
                        </div>
                </div>
                <hr>
                </hr>
                <div class="sheet-container">
                        <button class="sheet-button-roll" type='roll' value='&{template:5eAttack} {{name=@{character_name}}}{{subtags=Power, @{inputAncestry} @{inputExperience}}} {{power=[[1d20+@{inputPower}]]}} {{poweradv=[[1d20+@{inputPower}]]}}'
                                name='roll_Power'>
                                <div>
                                        <h3>Power:&nbsp;<span name="attr_Power"></span></h3>
                                </div>
                        </button>
                        <div>
                                <h3>Toughness:&nbsp;<span name="attr_Toughness"></h3>
                        </div>
                </div>
                <hr>
                </hr>
                <div class="sheet-container">
                        <button class="sheet-button-roll" type='roll' value='&{template:5eAttack} {{name=@{character_name}}}{{subtags=Morale, @{inputAncestry} @{inputExperience}}} {{morale=[[1d20+@{inputMorale}]]}} {{moraleadv=[[1d20+@{inputMorale}]]}}'
                                name='roll_Morale'>
                                <div>
                                        <h3>Morale:&nbsp;<span name="attr_Morale"></span></h3>
                                </div>
                        </button>
                        <div>
                                <h3>Size:&nbsp;<input type="number" class="displaySize" name="attr_Size" value="@{Size_max}" /><span>/</span><span
                                                name="attr_Size_max"></span></h3>
                        </div>

                </div>
                <hr>
                </hr>
        </div>
        <div class="sheet-containerInput">
                <h3>Traits:</h3>

                <fieldset class="repeating_Traits">
                        <input type="text" class="traitName sheet-input" name="attr_TraitName" placeholder="Trait Name" />
                        <input type="text" class="traitDesc sheet-input" name="attr_TraitDesc" placeholder="Description"></textarea>
                </fieldset>
        </div>

        <div class="sheet-containerDisplay repeating-display">
                <fieldset hidden class="repeating_Traits sheet-display">
                        <div hidden class="sheet-repeatDisplay sheet-display">
                                <span hidden name="attr_TraitName"></span>
                        </div>
                </fieldset>
                <b>
                        <h3>Traits:</h3>
                </b>
                <fieldset class="repeating_Traits sheet-display">
                        <div class="sheet-repeatDisplay sheet-display">
                                <b><span name="attr_TraitName"></span><span display:inline-block;>.&nbsp;</span></b><span
                                        name="attr_TraitDesc">
                                </span>
                        </div>
                </fieldset>
        </div>
        <div class="sheet-containerInput">
                <div>
                        <h3>Orders:</h3>
                </div>

                <fieldset class="repeating_Orders">
                        <input type="text" class="orderName sheet-input" name="attr_OrderName" placeholder="Order Name" />
                        <input type="text" class="orderDesc sheet-input" name="attr_OrderDesc" placeholder="Description"></textarea>
                </fieldset>
        </div>
        <div class="sheet-containerDisplay repeating-display">
                <fieldset hidden class="repeating_Orders sheet-display">
                        <span hidden name="attr_OrderName"></span>
                </fieldset>
                <b>
                        <h3>Orders:</h3>
                </b>
                <fieldset class="repeating_Orders sheet-display">
                        <b><span name="attr_OrderName"></span><span display:inline-block;>.&nbsp;</span></b><span name="attr_OrderDesc">
                        </span>
                </fieldset>
        </div>
        <div class="sheet-containerInput">
                <h3>Actions:</h3>

                <fieldset class="repeating_Actions">
                        <label>Name:</label><input type="text" class="actionName sheet-input" name="attr_ActionName"
                                placeholder="Action Name" />
                        <label>Target:</label><input type="text" class="actionTarget sheet-input" name="attr_ActionTarget"
                                placeholder="1 unit" />
                        <label>AttackMod:</label><input type="number" class="actionAttack sheet-input" name="attr_ActionAttackMod"
                                placeholder="10" />
                        <label>PowerMod:</label><input type="number" class="actionPower sheet-input" name="attr_ActionPowerMod"
                                placeholder="5" />
                        <label>MoraleSaveDC:</label><input type="number" class="actionMoraleSaveDC sheet-input" name="attr_ActionMoraleSave"
                                placeholder="15" />
                        <label>Casualty:</label><input type="number" class="actionCasualty sheet-input" name="attr_ActionCasualty"
                                placeholder="3" />
                        <label>Description:</label><input type="text" class="actionDesc sheet-input" style="resize:vertical;"
                                name="attr_ActionDesc" placeholder="Description"></textarea>
                </fieldset>
        </div>
        <div class="sheet-containerDisplay repeating-display">
                <fieldset hidden class="repeating_Actions sheet-display">
                        <div hidden>
                                <input hidden type="text" class="actionName sheet-input" name="attr_ActionName" />
                        </div>
                </fieldset>
                <b>
                        <h3>Actions:</h3>
                </b>
                <fieldset class="repeating_Actions sheet-display">
                        <div hidden>
                                <input type="text" class="actionName sheet-input" name="attr_ActionName" />
                                <input type="text" class="actionTarget sheet-input" name="attr_ActionTarget" />
                                <input type="number" class="actionAttack sheet-input" name="attr_ActionAttackMod" />
                                <input type="number" class="actionPower sheet-input" name="attr_ActionPowerMod" />
                                <input type="number" class="actionMoraleSaveDC sheet-input" name="attr_ActionMoraleSave" />
                                <input type="number" class="actionCasualty sheet-input" name="attr_ActionCasualty" />
                                <input type="text" class="actionDesc sheet-input" style="resize:vertical;" name="attr_ActionDesc"></textarea>
                        </div>
                        <button type='roll' class="sheet-button-roll" value='&{template:5eAttack} {{name=@{character_name}}}{{subtags=@{actionName}}} {{target=@{actionTarget}}} {{attack=[[1d20+@{actionAttackMod}]]}} {{attackadv=[[1d20+@{actionAttackMod}]]}} {{power=[[1d20+@{actionPowerMod}]]}} {{poweradv=[[1d20+@{actionPowerMod}]]}} {{moraleSave=@{actionMoraleSave}}} {{description=@{actionDesc}}}'
                                name='roll_Action'>
                                <b>
                                        <h3><span name="attr_ActionName"></span><span display:inline-block;>.</span></h3>
                                </b>
                                <h3><span>&nbsp;Target:&nbsp;</span>
                                        <span name="attr_ActionTarget"></span><span>,&nbsp;Attack:&nbsp;
                                        </span>
                                        <span name="attr_ActionAttackMod"></span><span>,&nbsp;Power:&nbsp;
                                        </span>
                                        <span name="attr_ActionPowerMod"></span><span>,&nbsp;
                                        </span>
                                        <span name="attr_ActionDesc">
                                        </span></h3>
                        </button>
                </fieldset>
        </div>
</div>
<div class="sheet-tab-content sheet-containerStronghold">
        <input type='checkbox' class="sheet-editStrongCheckBox" name='attr_editEnabledStrong' value='1' checked='false' /><span></span>

        <div class="sheet-stronghold-input">
                <div class="col">
                        <div class="col">
                                <input type="text" class="sheet-input" name="attr_character_name" />
                                <div class="col">
                                        <input type="text" class="sheet-input" name="attr_StrongholdType" placeholder="Stronghold Type" />
                                </div>
                                <div class="col">
                                        <input type="text" class="sheet-input" name="attr_StrongholdSubtype"
                                                placeholder="Stronghold Subtype" />
                                </div>
                        </div>
                </div>
                <div class="3colrow">
                        <div class="col">
                                <label>Level</label><input type="number" class="sheet-input" name="attr_Level"
                                        placeholder="1" />
                        </div>
                        <div class="col">
                                <label>Influence Radius</label><input type="number" class="sheet-input" name="attr_InfluenceRadius"
                                        placeholder="1" />
                        </div>
                        <div class="col">
                                <label>Morale per Level</label><input type="number" class="sheet-input" name="attr_morale_per_level"
                                        placeholder="2" />
                        </div>
                </div>

                <div class="3colrow">
                        <div class="col">
                                <label>Treasury</label><input type="number" class="sheet-input sheet-expanding-number"
                                        name="attr_treasury" placeholder="-">
                        </div>
                        <div class="col">

                                <label>Unit Upkeep</label><input type="number" class="sheet-input" name="attr_UnitUpkeep"
                                        placeholder="10%">
                        </div>
                        <div class="col">
                                <label>Size</label><input type="number" class="sheet-input" name="attr_Size_max"
                                        placeholder="12" />
                        </div>
                </div>
                <div class="2colrow">
                        <div class="col">
                                <label>Toughness</label><input type="number" class="sheet-input" name="attr_Toughness"
                                        placeholder="15" />
                        </div>
                        <div class="col">
                                <label>Speed</label><input type="number" class="sheet-input" name="attr_speed"
                                        placeholder="0" />
                        </div>
                </div>
                <h3>Demesne Effects</h3>
                <fieldset class="repeating_demesneeffects">
                        <input type="text" class="demesne-effect sheet-input" name="attr_demesne_effect_desc"
                                placeholder="Demesne Effect" />
                </fieldset>
                <h3>Artisans</h3>
                <fieldset class="repeating_artisans">
                        <input type="text" class="artisan-name sheet-input" name="attr_ArtisanName" placeholder="Name" />
                        <input type="text" class="artisan-type sheet-input" name="attr_ArtisanType" placeholder="Type" />
                        <input type="number" class="artisan-level sheet-input" name="attr_ArtisanLevel" placeholder="1" />
                        <input type="text" class="artisan-descritpion sheet-input" name="attr_ArtisanDesc" placeholder="Description" />
                </fieldset>
        </div>
        <div class="sheet-stronghold-display">
                <h2><span name="attr_character_name"></span></h2>
                <hr>
                </hr>
                <h3><span display:inline-block;>Level&nbsp;</span><span name="attr_Level"></span><span>&nbsp;</span><span
                                name="attr_StrongholdType"></span><span display:inline-block;>,&nbsp;</span><span name="attr_StrongholdSubtype">
                        </span></h3>
                <div class="2colrow">
                        <div class="col">
                                <h3><span display:inline-block;>Upkeep: &nbsp;</span><span name="attr_UnitUpkeep"></span></h3>

                        </div>
                        <div class="col">
                                <h3><span display:inline-block;>Treasury (gp):&nbsp;</span> <input type="number" class="sheet-input sheet-expanding-number"
                                                name="attr_treasury" placeholder="-"></h3>
                                </span>
                        </div>
                </div>
                <div class="2colrow">
                        <div class="col">
                                <h3><span display:inline-block;>Morale Bonus:&nbsp;</span><input type="number" name="attr_strong_morale_bonus"
                                                value="@{morale_per_level} * @{stronglevel}" disabled="true" /></h3>
                        </div>
                        <div class="col">
                                <h3><span display:inline-block;>Size: &nbsp;</span><input type="number" name="attr_strongsize"></span><span>/</span><span
                                                name="attr_Size_max"></span></h3>
                        </div>
                </div>
                <div class="2colrow">
                        <div class="col">
                                <h3><span display:inline-block;>Toughness:&nbsp;</span><span name="attr_Toughness"></span></h3>
                        </div>
                        <div class="col">
                                <h3><span display:inline-block;>Speed:&nbsp;</span><span name="attr_speed"></span></h3>
                        </div>
                </div>
                <hr>
                </hr>

                <div class="sheet-containerDisplay sheet-repeating-display">
                        <fieldset hidden class="repeating_demesneeffects sheet-display">
                                <span hidden name="attr_demesne_effect_desc"></span>
                        </fieldset>
                        <b>
                                <h3>Demesne Effects:</h3>
                        </b>
                        <fieldset class="repeating_demesneeffects sheet-display">
                                <h3><span name="attr_demesne_effect_desc"></span></h3>
                        </fieldset>
                </div>
                <div class="sheet-containerDisplay sheet-repeating-display">
                        <fieldset hidden class="repeating_artisans sheet-display">
                                <span hidden name="attr_ArtisanName"></span>
                        </fieldset>
                        <b>
                                <h3>Artisans:</h3>
                        </b>
                        <fieldset class="repeating_artisans sheet-display">
                                <h3><span name="attr_ArtisanName"></span><span>.&nbsp;</span><span name="attr_ArtisanType"></span><span>,&nbsp;Level&nbsp;</span><span
                                                name="attr_ArtisanLevel"></span><span>,&nbsp;</span><span name="attr_ArtisanDesc"></span></h3>
                        </fieldset>
                </div>
        </div>
</div>
<div class="sheet-tab-content sheet-containerProvince">
        <input type='checkbox' class="sheet-editProvinceCheckBox" name='attr_editEnabledProvince' value='1' checked='false' /><span></span>
        <div class="sheet-province-input">
                <input type="text" class="sheet-input" name="attr_character_name" />
                <hr>
                </hr>
                <div class="sheet-split sheet-left">
                        <div class="2colrow">
                                <div class="col">
                                        <label>Population</label><input type="number" class="sheet-input" name="attr_Population"
                                                placeholder="2" />
                                </div>
                                <div class="col">
                                        <label>Population di</label><select class="sheet-input" name="attr_PopulationDi">
                                                <option value="4">d4</option>
                                                <option value="6">d6</option>
                                                <option value="8">d8</option>
                                                <option value="10">d10</option>
                                                <option value="12">d12</option>
                                        </select>
                                </div>
                        </div>
                        <div class="2colrow">
                                <div class="col">
                                        <label>Law</label><input type="number" class="sheet-input" class="sheet-input"
                                                name="attr_Law" placeholder="1" />
                                </div>
                                <div class="col">
                                        <label>Law Upkeep (gp/year)</label><input type="number" class="sheet-input sheet-expanding-number"
                                                name="attr_LawUpkeep" placeholder="1000" />
                                </div>
                        </div>
                        <div class="2colrow">
                                <div class="col">
                                        <label>Development</label><input type="number" class="sheet-input" name="attr_Development"
                                                placeholder="1" />
                                </div>
                                <div class="col">
                                        <label>Unrest</label><input type="number" class="sheet-input" name="attr_Unrest"
                                                placeholder="0" />
                                </div>
                        </div>
                        <hr>
                        </hr>
                        <h3><b>Power Centres:</b></h3>
                        <fieldset class="repeating_PowerCentres">
                                <label>Name: </label><input type="text" class="resource-name sheet-input" name="attr_PowerCentreName"
                                        placeholder="Neverwinter" />
                                <label>Type: </label><input type="text" class="resource-type sheet-input" name="attr_PowerCentreType"
                                        placeholder="City" />
                        </fieldset>

                        <h3><b>Resources:</b></h3>
                        <fieldset class="repeating_resources">
                                <label>Name: </label><input type="text" class="resource-name sheet-input" name="attr_ResourceName"
                                        placeholder="Oak" />
                                <label>Type: </label><select class="resource-type sheet-input" name="attr_ResourceType"
                                        placeholder="Wood">
                                        <option value="Food">Food</option>
                                        <option value="Metal">Metal</option>
                                        <option value="Stone">Stone</option>
                                        <option value="Wood">Wood</option>
                                        <option value="Exotic">Exotic</option>
                                </select>
                                <label>Quantity: </label><input type="number" class="resource-quantity sheet-input"
                                        name="attr_ResourceQuantity" placeholder="1" />
                                <label>Value (gp): </label><input type="number" class="resource-value sheet-input sheet-input sheet-expanding-number"
                                        name="attr_ResourceValue" placeholder="300" />
                                <label>Source: </label><input type="text" class="resource-source sheet-input" name="attr_ResourceSource"
                                        placeholder="The Brynn Woods" />
                                <label>Units Traded: </label><input type="number" class="resource-source sheet-input"
                                        name="attr_ResourceTraded" placeholder="0" />
                                <label>Traded to: </label><input type="text" class="resource-source sheet-input" name="attr_ResourceTradePartner"
                                        placeholder="Waterdeep" />
                                <hr>
                                </hr>
                        </fieldset>
                        <h3><b>Imports:</b></h3>
                        <fieldset class="repeating_imports">
                                <label>Name: </label><input type="text" class="resource-name sheet-input" name="attr_ImportName"
                                        placeholder="Silk" />
                                <label>Type: </label><select class="resource-type sheet-input" name="attr_ImportType"
                                        placeholder="Wood">
                                        <option value="Food">Food</option>
                                        <option value="Metal">Metal</option>
                                        <option value="Stone">Stone</option>
                                        <option value="Wood">Wood</option>
                                        <option value="Exotic">Exotic</option>
                                </select>
                                <label>Quantity: </label><input type="number" class="resource-quantity sheet-input"
                                        name="attr_ImportQuantity" placeholder="1" />
                                <label>Value (gp): </label><input type="number" class="resource-value sheet-input sheet-input sheet-expanding-number"
                                        name="attr_ImportValue" placeholder="300" />
                                <label>Source: </label><input type="text" class="resource-source sheet-input" name="attr_ImportSource"
                                        placeholder="Neverwinter" />
                                <hr>
                                </hr>
                        </fieldset>

                </div>
                <div class="sheet-split sheet-right">
                        <h3><b>Stockpile</b></h3>
                        <div class="2colrow">
                                <div class="col">
                                        <label>Food:</label><input type="number" class="stockpile sheet-input" name="attr_FoodStock"
                                                placeholder="1" />
                                </div>
                                <div class="col">
                                        <label>Metal:</label><input type="number" class="stockpile sheet-input" name="attr_MetalStock"
                                                placeholder="1" />
                                </div>
                        </div>
                        <div class="2colrow">
                                <div class="col">
                                        <label>Stone:</label><input type="number" class="stockpile sheet-input" name="attr_StoneStock"
                                                placeholder="1" />
                                </div>
                                <div class="col">
                                        <label>Wood:</label><input type="number" class="stockpile sheet-input" name="attr_WoodStock"
                                                placeholder="1" />
                                </div>
                        </div>
                        <div class="2colrow">
                                <div class="col">
                                        <label>Exotic:</label><input type="number" class="stockpile sheet-input" name="attr_ExoticStock"
                                                placeholder="1" />
                                </div>
                                <div class="col">
                                        <label>Treasury:</label><input type="number" class="stockpile sheet-input sheet-expanding-number"
                                                name="attr_treasury" placeholder="1" />
                                </div>
                        </div>
                        <h3>Seasonal Revenue:</h3>
                        <h3><span display:inline-block;>Tax Revenue:&nbsp;</span><span name="attr_TaxRevenue"></span></h3>
                        <h3><span display:inline-block;>Trade:&nbsp;</span><span name="attr_TradeValue"></span><span>gp</span></h3>
                        <h3><span display:inline-block;>Population assigned:&nbsp;</span><span name="attr_population_assigned"></span></h3>

                </div>
                <hr>
                </hr>
        </div>
        <div class="sheet-province-display">
                <h2><span name="attr_character_name"></span></h2>
                <hr>
                </hr>
                <div class="split left">
                        <div class="2colrow">
                                <div class="col stat-head">
                                        <h3 class="header">Population:</h3>
                                </div>
                                <div class="col stat-head">
                                        <h3 class="header">Development:</h3>
                                </div>
                        </div>
                        <div class="2colrow">
                                <div class="col stat-value">
                                        <h3 class="header"><span name="attr_Population"></span></h3>
                                </div>
                                <div class="col stat-value">
                                        <h3 class="header"><span name="attr_Development"></span></h3>
                                </div>
                        </div>
                        <div class="2colrow">
                                <div class="col stat-head">
                                        <h3 class="header">Law:</h3>
                                </div>
                                <div class="col stat-head">
                                        <h3 class="header">Unrest:</h3>
                                </div>
                        </div>
                        <div class="2colrow">
                                <div class="col stat-value">
                                        <h3 class="header"><span name="attr_Law"></span></h3>
                                </div>
                                <div class="col stat-value">
                                        <h3 class="header"><span name="attr_Unrest"></span></h3>
                                </div>
                        </div>
                        <h3><b>Power Centres:</b></h3>
                        <fieldset class="repeating_PowerCentres sheet-repeating-display sheet-display">
                                <b><span name="attr_PowerCentreName"></span><span>.&nbsp;</span></b><span name="attr_PowerCentreType"></span>
                        </fieldset>
                        <h3><b>Resources:</b> </h3>
                        <h3><span display:inline-block;>Population assigned:&nbsp;</span><span name="attr_population_assigned"></span><span>/</span><span
                                        name="attr_Population"></span></h3>
                        <fieldset class="repeating_resources sheet-repeating-display sheet-display">

                                <input type="checkbox" class="sheet-resource" name="attr_ResourceAssigned" value="1" /><span></span>
                                <span class="colour-change">
                                        <b><span name="attr_ResourceName"></span></b><span>,&nbsp;</span>
                                        <span name="attr_ResourceType"></span><span>,&nbsp;</span><span>from&nbsp;</span><span
                                                name="attr_ResourceSource"></span><span>. Generates&nbsp;</span><span
                                                name="attr_ResourceQuantity"></span><span>&nbsp;units per season at
                                        </span>
                                        <span name="attr_ResourceValue"></span><span>gp per unit.</span>
                                </span>
                        </fieldset>
                        <h3><b>Imports:</b></h3>
                        <fieldset class="repeating_imports sheet-repeating-display sheet-display">
                                <b><span name="attr_ImportName"></span></b><span>,&nbsp;</span>
                                <span name="attr_ImportType"></span><span>,&nbsp;</span><span>from&nbsp;</span><span
                                        name="attr_ImportSource"></span><span>. Generates&nbsp;</span><span name="attr_ImportQuantity"></span><span>&nbsp;units
                                        per season at
                                </span>
                                <span name="attr_ImportValue"></span><span>gp per unit.</span>
                        </fieldset>
                </div>
                <div class="split right">
                        <div class="2colrow">
                                <div class="col stat-head">
                                        <h3 class="header">Food:</h3>
                                </div>
                                <div class="col stat-head">
                                        <h3 class="header">Metal:</h3>
                                </div>
                        </div>
                        <div class="2colrow">
                                <div class="col stat-value">
                                        <h3 class="header"><span name="attr_FoodStock"></span></h3>
                                </div>
                                <div class="col stat-value">
                                        <h3 class="header"><span name="attr_MetalStock"></span></h3>
                                </div>
                        </div>
                        <div class="2colrow">
                                <div class="col stat-head">
                                        <h3 class="header">Stone:</h3>
                                </div>
                                <div class="col stat-head">
                                        <h3 class="header">Wood:</h3>
                                </div>
                        </div>
                        <div class="2colrow">
                                <div class="col stat-value">
                                        <h3 class="header"><span name="attr_StoneStock"></span></h3>
                                </div>
                                <div class="col stat-value">
                                        <h3 class="header"><span name="attr_WoodStock"></span></h3>
                                </div>
                        </div>
                        <div class="2colrow">
                                <div class="col stat-head">
                                        <h3 class="header">Exotic:</h3>
                                </div>
                                <div class="col stat-head">
                                        <h3 class="header">Treasury (gp):</h3>
                                </div>
                        </div>
                        <div class="2colrow">
                                <div class="col stat-value">
                                        <h3 class="header"><span name="attr_ExoticStock"></span></h3>
                                </div>
                                <div class="col stat-value">
                                        <h3 class="header"><input type="number" class="sheet-input sheet-expanding-number sheet-display-input"
                                                        name="attr_treasury"></h3>
                                </div>
                        </div>
                        <h3>Seasonal Revenue:</h3>

                        <div class="2colrow">
                                        <div class="col stat-head">
                                                <h3 class="header">Food:</h3>
                                        </div>
                                        <div class="col stat-head">
                                                <h3 class="header">Metal:</h3>
                                        </div>
                                </div>
                                <div class="2colrow">
                                        <div class="col stat-value">
                                                <h3 class="header"><span name="attr_SeasonFood"></span></h3>
                                        </div>
                                        <div class="col stat-value">
                                                <h3 class="header"><span name="attr_SeasonMetal"></span></h3>
                                        </div>
                                </div>
                                <div class="2colrow">
                                        <div class="col stat-head">
                                                <h3 class="header">Stone:</h3>
                                        </div>
                                        <div class="col stat-head">
                                                <h3 class="header">Wood:</h3>
                                        </div>
                                </div>
                                <div class="2colrow">
                                        <div class="col stat-value">
                                                <h3 class="header"><span name="attr_SeasonStone"></span></h3>
                                        </div>
                                        <div class="col stat-value">
                                                <h3 class="header"><span name="attr_SeasonWood"></span></h3>
                                        </div>
                                </div>
                                <div class="2colrow">
                                        <div class="col stat-head">
                                                <h3 class="header">Exotic:</h3>
                                        </div>
                                        <div class="col stat-head">
                                                <h3 class="header">Income (gp):</h3>
                                        </div>
                                </div>
                                <div class="2colrow">
                                        <div class="col stat-value">
                                                <h3 class="header"><span name="attr_SeasonExotic"></span></h3>
                                        </div>
                                        <div class="col stat-value">
                                                        <h3 class="header"><span name="attr_SeasonRevenue"></span></h3>
                                        </div>
                                </div>
        
        

                </div>
        </div>
        <hr>
        </hr>
</div>

</div>

<script type="text/worker">
        const repeatingSum = (destination, section, fields, multiplier = 1) => {
                if (!Array.isArray(fields)) fields = [fields];
                getSectionIDs(`repeating_${section}`, idArray => {
                    const attrArray = idArray.reduce( (m,id) => [...m, ...(fields.map(field => `repeating_${section}_${id}_${field}`))],[]);
                    getAttrs(attrArray, v => {
                        console.log("===== values of v: "+ JSON.stringify(v) +" =====");
                        const getValue = (section, id,field) => parseFloat(v[`repeating_${section}_${id}_${field}`], 10)||0; // default value of 1, so any faulty value inputs are ignored and the calculation still works.
                        const sumTotal = idArray.reduce((total, id) => total + fields.reduce((subtotal,field) => subtotal * getValue(section, id,field),1),0);
                        setAttrs({[destination]: sumTotal * multiplier});    
                    });
                });
            };
            
            on('change:repeating_resources remove:repeating_resources', function() {
                repeatingSum("trade_total", "resources", ["ResourceAssigned", "ResourceTraded", "ResourceValue"]);
                repeatingSum("population_assigned", "resources", "ResourceAssigned");
        });

        on('change:repeating_imports remove:repeating_imports', function() {
                repeatingSum("import_total", "imports", [ "ImportQuantity", "ImportValue"]);
        });

        on("change:Development change:Population sheet:opened", function() {  //sheet:opened is optional, but is useful for some workers - the script runs every time the sheet opens.
                getAttrs(["Development","Population"], function(values) {
                     let Development = parseInt(values.Development)||0;   // wrap this in a parseInt function if you need it to be a number
                     let Population = parseInt(values.Population)||0;    // like so
                        var calcValue = Development * Population * 1000
                     setAttrs({ 
                             TaxRevenue: calcValue                          
                     });
               });
             });
             /*get seasonal resources*/
             on('change:repeating_resources remove:repeating_resources', function () {
                 var wood = 0, stone = 0, metal = 0, exotic = 0, food = 0;
                 var tmpAssinged, tmpQuantity, tmpTraded;
                 var tmpType;
                 getSectionIDs("repeating_resources", idarray => {
                     for (let i = 0; i < idarray.length; i++) {
                         getAttrs([`repeating_resources_${idarray[i]}_ResourceAssigned`, `repeating_resources_${idarray[i]}_ResourceType`, `repeating_resources_${idarray[i]}_ResourceQuantity`, `repeating_resources_${idarray[i]}_ResourceTraded`], function (v) {
                             tmpAssinged = Object.values(v)[0].valueOf();
                             tmpType = Object.values(v)[1].valueOf();
                             tmpQuantity = Object.values(v)[2].valueOf();
                             tmpTraded = Object.values(v)[3].valueOf();
                             tmp = tmpAssinged * (tmpQuantity - tmpTraded);
                             if (tmpType == "Wood") { wood += tmp;  }
                             else if (tmpType == "Stone") { stone += tmp; }
                             else if (tmpType == "Metal") { metal += tmp;  }
                             else if (tmpType == "Exotic") { exotic += tmp; }
                             else if (tmpType == "Food") { food += tmp; }
                             if (i == idarray.length -1 ) {setAttrs({ WorkWood: wood, WorkStone: stone, WorkMetal: metal, WorkExotic: exotic, WorkFood: food })}
                         });
                     } 
                 });
             });   
             on('change:repeating_imports remove:repeating_imports', function () {
                var wood = 0, stone = 0, metal = 0, exotic = 0, food = 0;
                var tmpQuantity;
                var tmpType;
                getSectionIDs("repeating_imports", idarray => {
                    for (let i = 0; i < idarray.length; i++) {
                        getAttrs([`repeating_imports_${idarray[i]}_ImportType`, `repeating_imports_${idarray[i]}_ImportQuantity`], function (v) {
                            tmpType = Object.values(v)[0].valueOf();
                            tmpQuantity = Object.values(v)[1].valueOf();
                            tmp = 1 * (tmpQuantity);
                            if (tmpType == "Wood") { wood += tmp;}
                            else if (tmpType == "Stone") { stone += tmp;}
                            else if (tmpType == "Metal") { metal += tmp;}
                            else if (tmpType == "Exotic") { exotic += tmp;}
                            else if (tmpType == "Food") { food += tmp;}
                            if(i == idarray.length -1 ) {setAttrs({ ImportWood: wood, ImportStone: stone, ImportMetal: metal, ImportExotic: exotic, ImportFood: food })}
                        });
                    }
                })
            });                                                 
             on("change:WorkWood change:ImportWood", function () {  
                     getAttrs(["WorkWood", "ImportWood"], function (values) {
                     let wood = (parseInt(values.WorkWood) || 0) + (parseInt(values.ImportWood) || 0)  ;   // wrap this in a parseInt function if you need it to be a number
                     setAttrs({
                         SeasonWood: wood
                     });
                 });
             });
             on("change:WorkStone change:ImportStone", function () {  
                 getAttrs(["WorkStone", "ImportStone"], function (values) {
                 let stone = (parseInt(values.WorkStone) || 0) + (parseInt(values.ImportStone) || 0);    // like so
                 setAttrs({
                     SeasonStone: stone
                 });
             });
             });
             on("change:WorkMetal change:ImportMetal", function () {  
                 getAttrs(["WorkMetal", "ImportMetal"], function (values) {
                 let metal = (parseInt(values.WorkMetal) || 0)+ (parseInt(values.ImportMetal) || 0) ; 
                 setAttrs({
                     SeasonMetal: metal
                 });
             });
             });
             on("change:WorkExotic change:ImportExotic", function () {  
                 getAttrs(["WorkExotic","ImportExotic"], function (values) {
                 let exotic = (parseInt(values.WorkExotic) || 0)+ (parseInt(values.ImportExotic) || 0) ; 
                 setAttrs({
                     SeasonExotic: exotic
                 });
             });
             });
             on("change:WorkFood change:ImportFood", function () {  
                 getAttrs(["WorkFood", "ImportFood"], function (values) {
                 let food = (parseInt(values.WorkFood) || 0)+ (parseInt(values.ImportFood) || 0) ; 
                 setAttrs({
                     SeasonFood: food
                 });
             });
             });                                           
             on("change:trade_total change:import_total change:TaxRevenue", function () {  
                getAttrs(["trade_total", "import_total", "TaxRevenue"], function (values) {
                    let tmp = (parseInt(values.trade_total) || 0) - (parseInt(values.import_total) || 0) + (parseInt(values.TaxRevenue) || 0) ;  
                setAttrs({
                    SeasonRevenue: tmp 
                });
            });
            });
</script>

<rolltemplate class="sheet-rolltemplate-5eAttack">
        <div class="container">
                <div>
                        <h1>{{name}}</h1>
                </div>
                <div><span class="subheader">{{subtags}}</span></div>
                <div class="arrow-container">
                        <div class="arrow-right"></div>
                </div>
                {{#target}}
                <div class="rowcolor"><span class="tcat">Target: </span>{{target}}</div>
                {{/target}}
                {{#attack}}
                <div class="rowcolor"><span class="tcat">Attack: </span>{{attack}} | {{attackadv}} vs
                        Defence</div>
                {{/attack}}
                {{#power}}
                <div class="rowcolor"><span class="tcat">Power: </span>{{power}} | {{poweradv}} vs
                        Toughness</div>
                {{/power}}
                {{#morale}}
                <div class="rowcolor"><span class="tcat">Morale Check: </span>{{morale}} |
                        {{moraleadv}}</div>
                {{/morale}}
                {{#moraleSave}}
                <div class="rowcolor"><span class="tcat">Morale Save DC: </span>{{moraleSave}}</div>
                {{/moraleSave}}
                {{#description}}
                <div class="rowcolor"><span class="tcat">Description: </span>{{description}}</div>
                {{/description}}
                {{#damage}}
                <div>
                        <span class="tcat">Damage: </span>{{damage}}
                        <span class="tcat">Crit: </span>{{dmgcrit}}
                </div>
                {{/damage}}
                {{#snkattk}}
                <div>
                        <span class="tcat">Sneak Attack: </span>{{snkattk}}
                        <span class="tcat">Crit: </span>{{snkcrit}}
                </div>
                {{/snkattk}}
        </div>
</rolltemplate>